<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Staff Tracking - –£—Å–ª—É–≥–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤</title>
<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
<link rel="stylesheet" href="styles.css">
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: 'Manrope', sans-serif; background: #f5f5f5; }
.header { background: white; padding: 16px 40px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
.logo { display: flex; align-items: center; gap: 12px; }
.logo .material-symbols-outlined { font-size: 36px; color: #135bec; }
.logo h1 { font-size: 24px; color: #1e293b; font-weight: 700; }
.nav-links { display: flex; gap: 32px; align-items: center; }
.nav-links a { text-decoration: none; color: #475569; font-weight: 500; transition: color 0.2s; }
.nav-links a:hover { color: #135bec; }
.auth-buttons { display: flex; gap: 12px; }
.user-menu { display: none; position: relative; }
.user-info { display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: #f8fafc; border-radius: 8px; cursor: pointer; transition: all 0.2s; border: 2px solid #e2e8f0; }
.user-info:hover { background: #f1f5f9; border-color: #135bec; }
.user-avatar { font-size: 20px; }
.user-name { font-weight: 600; color: #1e293b; font-size: 14px; }
.dropdown-arrow { font-size: 10px; color: #64748b; transition: transform 0.2s; }
.dropdown-arrow.active { transform: rotate(180deg); }
.user-dropdown { position: absolute; top: calc(100% + 8px); right: 0; background: white; border-radius: 8px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15); min-width: 200px; display: none; z-index: 1001; overflow: hidden; }
.user-dropdown.active { display: block; animation: slideIn 0.2s ease; }
.dropdown-item { display: flex; align-items: center; gap: 10px; padding: 12px 16px; color: #475569; text-decoration: none; transition: all 0.2s; font-size: 14px; }
.dropdown-item:hover { background: #f8fafc; color: #135bec; }
.dropdown-item:first-child { border-bottom: 1px solid #f1f5f9; }
.btn { padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s; border: none; font-family: 'Manrope', sans-serif; font-size: 14px; }
.btn-outline { background: transparent; border: 2px solid #135bec; color: #135bec; }
.btn-outline:hover { background: #135bec; color: white; }
.btn-primary { background: #135bec; color: white; }
.btn-primary:hover { background: #0d4bd6; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(19, 91, 236, 0.3); }
.btn-success { background: #10b981; color: white; }
.btn-success:hover { background: #059669; }
.hero { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 80px 40px; text-align: center; }
.hero h2 { font-size: 48px; margin-bottom: 16px; font-weight: 800; }
.hero p { font-size: 20px; margin-bottom: 32px; opacity: 0.95; }
.search-box { max-width: 700px; margin: 0 auto; display: flex; gap: 12px; }
.search-box input { flex: 1; padding: 16px 24px; border: none; border-radius: 12px; font-size: 16px; font-family: 'Manrope', sans-serif; }
.search-box button { padding: 16px 32px; background: #135bec; color: white; border: none; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 16px; }
.services-section { padding: 60px 40px; max-width: 1400px; margin: 0 auto; }
.section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 32px; }
.section-header h3 { font-size: 32px; color: #1e293b; }
.filters { display: flex; gap: 12px; }
.filters select, .filters input { padding: 10px 16px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px; }
.services-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 24px; }
.service-card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.3s; cursor: pointer; }
.service-card:hover { transform: translateY(-4px); box-shadow: 0 8px 24px rgba(0,0,0,0.15); }
.service-image { height: 200px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; font-size: 64px; }
.service-info { padding: 20px; }
.service-price { font-size: 24px; font-weight: 700; color: #135bec; margin-bottom: 8px; }
.service-title { font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 8px; }
.service-description { color: #64748b; font-size: 14px; margin-bottom: 16px; line-height: 1.5; }
.service-meta { display: flex; justify-content: space-between; align-items: center; padding-top: 16px; border-top: 1px solid #e2e8f0; }
.worker-info { display: flex; align-items: center; gap: 8px; }
.worker-avatar { width: 32px; height: 32px; border-radius: 50%; background: #135bec; color: white; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; }
.worker-name { font-weight: 500; color: #475569; font-size: 14px; }
.service-rating { display: flex; align-items: center; gap: 4px; color: #f59e0b; font-weight: 600; }
.modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px); z-index: 1000; }
.modal.active { display: flex; justify-content: center; align-items: center; }
.modal-content { background: white; border-radius: 12px; width: 90%; max-width: 500px; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); animation: slideIn 0.3s ease; }
.modal-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 24px; border-bottom: 1px solid #e2e8f0; }
.modal-header h2 { margin: 0; font-size: 1.25rem; color: #1e293b; }
.modal-close { background: none; border: none; font-size: 28px; cursor: pointer; color: #64748b; line-height: 1; padding: 0; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 6px; transition: all 0.2s; }
.modal-close:hover { background: #f1f5f9; color: #1e293b; }
.modal-body { padding: 24px; }
.form-group { margin-bottom: 16px; }
.form-group label { display: block; margin-bottom: 8px; color: #475569; font-size: 14px; }
.form-group input, .form-group textarea { width: 100%; padding: 12px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px; font-family: 'Manrope', sans-serif; }
.form-group input:focus, .form-group textarea:focus { outline: none; border-color: #135bec; box-shadow: 0 0 0 3px rgba(19, 91, 236, 0.1); }
.service-modal .modal-content { max-width: 900px; width: 95%; }
.service-modal-header { position: relative; height: 300px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; font-size: 120px; }
.service-modal-close { position: absolute; top: 20px; right: 20px; background: white; border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 24px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 2px 8px rgba(0,0,0,0.2); }
.service-modal-body { padding: 32px; }
.service-modal-title { font-size: 32px; font-weight: 700; color: #1e293b; margin-bottom: 16px; }
.service-modal-price { font-size: 28px; color: #135bec; font-weight: 700; margin-bottom: 24px; }
.service-section { margin-bottom: 32px; }
.service-section h4 { font-size: 20px; color: #1e293b; margin-bottom: 16px; display: flex; align-items: center; gap: 8px; }
.service-section h4 .material-symbols-outlined { color: #135bec; }
.service-description-text { color: #475569; line-height: 1.8; font-size: 15px; }
.characteristics-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
.characteristic-item { background: #f8fafc; padding: 16px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; }
.characteristic-label { color: #64748b; font-size: 14px; }
.characteristic-value { font-weight: 600; color: #1e293b; }
.photos-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
.photo-item { aspect-ratio: 1; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 48px; cursor: pointer; transition: transform 0.2s; }
.photo-item:hover { transform: scale(1.05); }
.worker-card { background: #f8fafc; padding: 20px; border-radius: 12px; display: flex; align-items: center; gap: 20px; }
.worker-photo { width: 80px; height: 80px; border-radius: 50%; background: #135bec; color: white; display: flex; align-items: center; justify-content: center; font-size: 36px; font-weight: 700; }
.worker-details h5 { font-size: 20px; color: #1e293b; margin-bottom: 4px; }
.worker-details p { color: #64748b; font-size: 14px; margin-bottom: 8px; }
.worker-rating { display: flex; align-items: center; gap: 8px; }
.reviews-section { margin-top: 24px; }
.review-item { background: #f8fafc; padding: 16px; border-radius: 8px; margin-bottom: 12px; }
.review-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
.review-author { font-weight: 600; color: #1e293b; }
.review-date { color: #94a3b8; font-size: 13px; }
.review-text { color: #475569; font-size: 14px; line-height: 1.6; }
.modal-actions { display: flex; gap: 12px; margin-top: 32px; padding-top: 24px; border-top: 1px solid #e2e8f0; }
.modal-actions .btn { flex: 1; padding: 16px; font-size: 16px; }
@keyframes slideIn { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
</style>
</head>
<body>

<header class="header">
    <div class="logo">
        <span class="material-symbols-outlined">engineering</span>
        <h1>Staff Tracking</h1>
    </div>
    <nav class="nav-links">
        <a href="#services">–£—Å–ª—É–≥–∏</a>
        <a href="#about">–û –Ω–∞—Å</a>
        <a href="#contacts">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
    </nav>
    
    <div class="auth-buttons" id="authButtons">
        <button class="btn btn-outline" onclick="openLoginModal()">–í–æ–π—Ç–∏</button>
        <button class="btn btn-primary" onclick="openRegisterModal()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
    </div>
    
    <div class="user-menu" id="userMenu">
        <div class="user-info" onclick="toggleUserDropdown()">
            <span class="user-avatar">üë§</span>
            <span id="userName" class="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            <span class="dropdown-arrow">‚ñº</span>
        </div>
        <div id="userDropdown" class="user-dropdown">
            <!-- –°–°–´–õ–ö–ê –ú–ï–ù–Ø–ï–¢–°–Ø –í –ó–ê–í–ò–°–ò–ú–û–°–¢–ò –û–¢ –†–û–õ–ò -->
            <a href="#" id="dashboardLink" class="dropdown-item">üìã –ú–æ–∏ –∑–∞–∫–∞–∑—ã</a>
            <a href="#" class="dropdown-item" onclick="logout(); return false;">üö™ –í—ã–π—Ç–∏</a>
        </div>
    </div>
</header>

<section class="hero">
    <h2>–ù–∞–π–¥–∏—Ç–µ –ª—É—á—à–∏—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤</h2>
    <p>–¢—ã—Å—è—á–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤ –≥–æ—Ç–æ–≤—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤–∞—à—É —Ä–∞–±–æ—Ç—É</p>
    <div class="search-box">
        <input type="text" placeholder="–ö–∞–∫—É—é —É—Å–ª—É–≥—É –≤—ã –∏—â–µ—Ç–µ?" id="searchInput">
        <button onclick="searchServices()">
            <span class="material-symbols-outlined" style="vertical-align: middle;">search</span>
            –ù–∞–π—Ç–∏
        </button>
    </div>
</section>

<section class="services-section" id="services">
    <div class="section-header">
        <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏</h3>
        <div class="filters">
            <select id="categoryFilter" onchange="filterServices()">
                <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                <option value="construction">–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ</option>
                <option value="repair">–†–µ–º–æ–Ω—Ç</option>
                <option value="electrical">–≠–ª–µ–∫—Ç—Ä–∏–∫–∞</option>
                <option value="plumbing">–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞</option>
            </select>
            <input type="number" placeholder="–¶–µ–Ω–∞ –¥–æ" id="priceFilter" onchange="filterServices()">
        </div>
    </div>
    <div class="services-grid" id="servicesGrid"></div>
</section>

<!-- Service Modal -->
<div id="serviceModal" class="modal service-modal">
    <div class="modal-content">
        <div class="service-modal-header">
            <button class="service-modal-close" onclick="closeServiceModal()">√ó</button>
            <span id="modalIcon">üèóÔ∏è</span>
        </div>
        <div class="service-modal-body">
            <h2 class="service-modal-title" id="modalTitle"></h2>
            <div class="service-modal-price" id="modalPrice"></div>
            <div class="service-section">
                <h4><span class="material-symbols-outlined">description</span> –û–ø–∏—Å–∞–Ω–∏–µ</h4>
                <p class="service-description-text" id="modalDescription"></p>
            </div>
            <div class="service-section">
                <h4><span class="material-symbols-outlined">tune</span> –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h4>
                <div class="characteristics-grid" id="modalCharacteristics"></div>
            </div>
            <div class="service-section">
                <h4><span class="material-symbols-outlined">photo_library</span> –§–æ—Ç–æ —Ä–∞–±–æ—Ç</h4>
                <div class="photos-grid" id="modalPhotos"></div>
            </div>
            <div class="service-section">
                <h4><span class="material-symbols-outlined">person</span> –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</h4>
                <div class="worker-card">
                    <div class="worker-photo" id="modalWorkerAvatar"></div>
                    <div class="worker-details">
                        <h5 id="modalWorkerName"></h5>
                        <p id="modalWorkerRole"></p>
                        <div class="worker-rating">
                            <span class="material-symbols-outlined" style="color: #f59e0b;">star</span>
                            <span id="modalWorkerRating"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="service-section reviews-section">
                <h4><span class="material-symbols-outlined">reviews</span> –û—Ç–∑—ã–≤—ã</h4>
                <div id="modalReviews"></div>
            </div>
            <div class="modal-actions">
                <button class="btn btn-outline" onclick="contactWorker()">–ù–∞–ø–∏—Å–∞—Ç—å</button>
                <button class="btn btn-success" onclick="orderService()">–ó–∞–∫–∞–∑–∞—Ç—å —É—Å–ª—É–≥—É</button>
            </div>
        </div>
    </div>
</div>

<!-- Login Modal -->
<div id="loginModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <button class="modal-close" onclick="closeLoginModal()">√ó</button>
        </div>
        <div class="modal-body">
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label>–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">–í–æ–π—Ç–∏</button>
            </form>
            <p style="text-align: center; margin-top: 16px; color: #64748b;">
                –ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <a href="#" onclick="closeLoginModal(); openRegisterModal();" style="color: #135bec;">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a>
            </p>
        </div>
    </div>
</div>

<script>
const services = [
    { id: 1, title: "–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ —Å—Ç–µ–Ω –∏ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–æ–∫", description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –≤–æ–∑–≤–µ–¥–µ–Ω–∏–µ —Å—Ç–µ–Ω –∏–∑ –∫–∏—Ä–ø–∏—á–∞, –≥–∞–∑–æ–±–ª–æ–∫–∞ –∏ –¥—Ä—É–≥–∏—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤.", fullDescription: "–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –ø–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Å —É—Å–ª—É–≥ –ø–æ –≤–æ–∑–≤–µ–¥–µ–Ω–∏—é —Å—Ç–µ–Ω –∏ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–æ–∫ –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.", price: 2500, category: "construction", worker: "–ú–∞–∫—Å–∏–º –°–≤–µ—Ç–∏–∫–æ–≤", workerRole: "–†—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å —É—á–∞—Å—Ç–∫–∞", rating: 4.9, reviewsCount: 127, icon: "üèóÔ∏è", characteristics: { "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã": "10 –ª–µ—Ç", "–ì–∞—Ä–∞–Ω—Ç–∏—è": "2 –≥–æ–¥–∞", "–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è": "–æ—Ç 3 –¥–Ω–µ–π", "–í—ã–µ–∑–¥": "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ" }, photos: ["üèóÔ∏è", "üß±", "üî®"], reviews: [{ author: "–ê–Ω–Ω–∞ –ö.", date: "15 —Ñ–µ–≤—Ä–∞–ª—è 2026", text: "–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞!" }, { author: "–°–µ—Ä–≥–µ–π –ú.", date: "10 —Ñ–µ–≤—Ä–∞–ª—è 2026", text: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥." }] },
    { id: 2, title: "–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã", description: "–ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –ø—Ä–æ–≤–æ–¥–∫–∏, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–æ–∑–µ—Ç–æ–∫, –≤—ã–∫–ª—é—á–∞—Ç–µ–ª–µ–π.", fullDescription: "–í—ã–ø–æ–ª–Ω—è–µ–º —ç–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.", price: 1500, category: "electrical", worker: "–ê–ª–µ–∫—Å –ü–µ—Ç—Ä–æ–≤", workerRole: "–≠–ª–µ–∫—Ç—Ä–∏–∫", rating: 4.8, reviewsCount: 93, icon: "‚ö°", characteristics: { "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã": "10 –ª–µ—Ç", "–ì–∞—Ä–∞–Ω—Ç–∏—è": "1 –≥–æ–¥", "–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è": "1-5 –¥–Ω–µ–π", "–í—ã–µ–∑–¥": "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ" }, photos: ["‚ö°", "üí°"], reviews: [{ author: "–î–º–∏—Ç—Ä–∏–π –í.", date: "18 —Ñ–µ–≤—Ä–∞–ª—è 2026", text: "–ë—ã—Å—Ç—Ä–æ –∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ!" }] },
    { id: 3, title: "–°–∞–Ω—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É—Å–ª—É–≥–∏", description: "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞—Å–æ—Ä–æ–≤, —Ä–µ–º–æ–Ω—Ç —Ç—Ä—É–±.", fullDescription: "–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—ã–π —Å–ø–µ–∫—Ç—Ä —Å–∞–Ω—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —É—Å–ª—É–≥.", price: 1200, category: "plumbing", worker: "–ò–≤–∞–Ω –î—É–¥–∞–µ–≤", workerRole: "–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫", rating: 4.7, reviewsCount: 156, icon: "üîß", characteristics: { "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã": "8 –ª–µ—Ç", "–ì–∞—Ä–∞–Ω—Ç–∏—è": "6 –º–µ—Å—è—Ü–µ–≤", "–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è": "–≤ –¥–µ–Ω—å –æ–±—Ä–∞—â–µ–Ω–∏—è", "–í—ã–µ–∑–¥": "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ" }, photos: ["üîß", "üöø", "üöΩ"], reviews: [{ author: "–û–ª–µ–≥ –ù.", date: "20 —Ñ–µ–≤—Ä–∞–ª—è 2026", text: "–ü—Ä–∏–µ—Ö–∞–ª —á–µ—Ä–µ–∑ —á–∞—Å!" }] },
    { id: 4, title: "–†–µ–º–æ–Ω—Ç –∫–≤–∞—Ä—Ç–∏—Ä –ø–æ–¥ –∫–ª—é—á", description: "–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.", fullDescription: "–í—ã–ø–æ–ª–Ω—è–µ–º —Ä–µ–º–æ–Ω—Ç –∫–≤–∞—Ä—Ç–∏—Ä –ø–æ–¥ –∫–ª—é—á –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.", price: 5000, category: "repair", worker: "–ê—Ä—Å–µ–Ω–∏–π –ê–ª—Ö–∏–º–æ–≤", workerRole: "–ü—Ä–æ—Ä–∞–±", rating: 4.9, reviewsCount: 214, icon: "üè†", characteristics: { "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã": "15 –ª–µ—Ç", "–ì–∞—Ä–∞–Ω—Ç–∏—è": "3 –≥–æ–¥–∞", "–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è": "–æ—Ç 1 –º–µ—Å—è—Ü–∞", "–î–∏–∑–∞–π–Ω-–ø—Ä–æ–µ–∫—Ç": "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ" }, photos: ["üè†"], reviews: [{ author: "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –†.", date: "22 —Ñ–µ–≤—Ä–∞–ª—è 2026", text: "–í—Å–µ –≤ —Å—Ä–æ–∫!" }] },
    { id: 5, title: "–£–∫–ª–∞–¥–∫–∞ –ø–ª–∏—Ç–∫–∏", description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —É–∫–ª–∞–¥–∫–∞ –ø–ª–∏—Ç–∫–∏.", fullDescription: "–£–∫–ª–∞–¥—ã–≤–∞–µ–º –ø–ª–∏—Ç–∫—É –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.", price: 1800, category: "repair", worker: "–ê–∑–∞–º–∞—Ç –î—É–¥–∞–µ–≤", workerRole: "–ü–ª–∏—Ç–æ—á–Ω–∏–∫", rating: 4.8, reviewsCount: 89, icon: "üî≤", characteristics: { "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã": "12 –ª–µ—Ç", "–ì–∞—Ä–∞–Ω—Ç–∏—è": "2 –≥–æ–¥–∞", "–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è": "3-7 –¥–Ω–µ–π", "–ú–∞—Ç–µ—Ä–∏–∞–ª—ã": "–õ—é–±—ã–µ" }, photos: ["üî≤", "üõÅ"], reviews: [{ author: "–í–∏–∫—Ç–æ—Ä –ü.", date: "19 —Ñ–µ–≤—Ä–∞–ª—è 2026", text: "–ò–¥–µ–∞–ª—å–Ω–æ!" }] },
    { id: 6, title: "–ú–æ–Ω—Ç–∞–∂ –Ω–∞—Ç—è–∂–Ω—ã—Ö –ø–æ—Ç–æ–ª–∫–æ–≤", description: "–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—Ç—è–∂–Ω—ã—Ö –ø–æ—Ç–æ–ª–∫–æ–≤.", fullDescription: "–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—Ç—è–∂–Ω—ã–µ –ø–æ—Ç–æ–ª–∫–∏ –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.", price: 800, category: "repair", worker: "–ê–Ω—Ç–æ–Ω –°–ø–∞—Ä—Ç–∞–∫", workerRole: "–ú–æ–Ω—Ç–∞–∂–Ω–∏–∫", rating: 4.6, reviewsCount: 178, icon: "üé™", characteristics: { "–û–ø—ã—Ç —Ä–∞–±–æ—Ç—ã": "7 –ª–µ—Ç", "–ì–∞—Ä–∞–Ω—Ç–∏—è": "10 –ª–µ—Ç", "–°—Ä–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è": "1 –¥–µ–Ω—å", "–ó–∞–º–µ—Ä": "–ë–µ—Å–ø–ª–∞—Ç–Ω–æ" }, photos: ["üé™", "üí°"], reviews: [{ author: "–°–≤–µ—Ç–ª–∞–Ω–∞ –î.", date: "21 —Ñ–µ–≤—Ä–∞–ª—è 2026", text: "–û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ!" }] }
];
let currentService = null;

// ============================================
// –ü–†–û–í–ï–†–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò (–ò–°–ü–†–ê–í–õ–ï–ù–û!)
// ============================================
document.addEventListener('DOMContentLoaded', function() {
    console.log('üîÑ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –ø—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é...');
    checkAuth();
    renderServices(services);
});

function checkAuth() {
    const token = localStorage.getItem('accessToken') || localStorage.getItem('token');
    const role = localStorage.getItem('userRole') || localStorage.getItem('role');
    const userName = localStorage.getItem('userName');
    
    const authButtons = document.getElementById('authButtons');
    const userMenu = document.getElementById('userMenu');
    const nameElement = document.getElementById('userName');
    const dashboardLink = document.getElementById('dashboardLink');
    
    console.log('‚úÖ checkAuth:', { token: !!token, role: role, userName: userName });
    
    if (token && userName) {
        if (authButtons) authButtons.style.display = 'none';
        if (userMenu) {
            userMenu.style.display = 'block';
            if (nameElement) nameElement.textContent = userName;
        }
        
        // üî• –í–ê–ñ–ù–û: –ú–µ–Ω—è–µ–º —Å—Å—ã–ª–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
        if (dashboardLink) {
            if (role === 'admin') {
                dashboardLink.textContent = 'üèóÔ∏è –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞';
                dashboardLink.href = '/admin.html';
                console.log('üîß –†–æ–ª—å: admin ‚Üí —Å—Å—ã–ª–∫–∞ –Ω–∞ /admin.html');
            } else if (role === 'customer') {
                dashboardLink.textContent = 'üìã –ú–æ–∏ –∑–∞–∫–∞–∑—ã';
                dashboardLink.href = '/customer.html';
                console.log('üë§ –†–æ–ª—å: customer ‚Üí —Å—Å—ã–ª–∫–∞ –Ω–∞ /customer.html');
            } else {
                dashboardLink.textContent = 'üìã –ú–æ–∏ –∑–∞–∫–∞–∑—ã';
                dashboardLink.href = '/customer.html';
            }
        }
        
        console.log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω:', userName);
    } else {
        if (authButtons) authButtons.style.display = 'flex';
        if (userMenu) userMenu.style.display = 'none';
        console.log('‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
    }
}

function toggleUserDropdown() {
    const dropdown = document.getElementById('userDropdown');
    const arrow = document.querySelector('.dropdown-arrow');
    if (dropdown && arrow) {
        dropdown.classList.toggle('active');
        arrow.classList.toggle('active');
    }
}

document.addEventListener('click', function(e) {
    const userMenu = document.getElementById('userMenu');
    const dropdown = document.getElementById('userDropdown');
    const arrow = document.querySelector('.dropdown-arrow');
    if (userMenu && !userMenu.contains(e.target)) {
        if (dropdown) dropdown.classList.remove('active');
        if (arrow) arrow.classList.remove('active');
    }
});

function logout() {
    localStorage.clear();
    window.location.href = "/auto.html";
}

function openLoginModal() {
    document.getElementById('loginModal').classList.add('active');
    document.body.style.overflow = 'hidden';
}

function closeLoginModal() {
    document.getElementById('loginModal').classList.remove('active');
    document.body.style.overflow = '';
}

function openRegisterModal() {
    alert('–§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–∞ soon!');
}

function closeServiceModal() {
    document.getElementById('serviceModal').classList.remove('active');
    document.body.style.overflow = '';
}

async function handleLogin(event) {
    event.preventDefault();
    
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    const submitBtn = event.target.querySelector('button[type="submit"]');
    const originalText = submitBtn.textContent;
    
    submitBtn.textContent = '‚è≥ –í—Ö–æ–¥...';
    submitBtn.disabled = true;
    
    console.log('üîê –ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞:', email);
    
    try {
        const response = await fetch('/api/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, password })
        });
        const data = await response.json();
        
        console.log('üì° –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:', data);
        
        if (data.success) {
            localStorage.setItem('accessToken', data.accessToken);
            localStorage.setItem('token', data.accessToken);
            localStorage.setItem('userRole', data.role);
            localStorage.setItem('role', data.role);
            
            try {
                const userInfoResponse = await fetch('/api/validate-token', {
                    method: 'POST',
                    headers: { 'Authorization': 'Bearer ' + data.accessToken }
                });
                const userInfo = await userInfoResponse.json();
                console.log('üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:', userInfo);
                
                if (userInfo.valid && userInfo.name) {
                    localStorage.setItem('userName', userInfo.name);
                    console.log('‚úÖ userName —Å–æ—Ö—Ä–∞–Ω—ë–Ω:', userInfo.name);
                } else {
                    localStorage.setItem('userName', email.split('@')[0]);
                }
            } catch (e) {
                localStorage.setItem('userName', email.split('@')[0]);
                console.log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å userName, –∏—Å–ø–æ–ª—å–∑—É–µ–º email');
            }
            
            closeLoginModal();
            checkAuth();
            
            setTimeout(() => {
                if (data.role === 'admin') {
                    console.log('üîÑ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ /admin.html');
                    window.location.href = '/admin.html';
                } else if (data.role === 'customer') {
                    console.log('üîÑ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ /customer.html');
                    window.location.href = '/customer.html';
                } else {
                    console.log('üîÑ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã');
                    window.location.reload();
                }
            }, 100);
        } else {
            alert('‚ùå ' + data.message);
            submitBtn.textContent = originalText;
            submitBtn.disabled = false;
        }
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
        alert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É');
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
    }
}

function renderServices(servicesToRender) {
    const grid = document.getElementById('servicesGrid');
    grid.innerHTML = servicesToRender.map(service => `
        <div class="service-card" onclick="openServiceModal(${service.id})">
            <div class="service-image">${service.icon}</div>
            <div class="service-info">
                <div class="service-price">${service.price} ‚ÇΩ/—á–∞—Å</div>
                <div class="service-title">${service.title}</div>
                <div class="service-description">${service.description}</div>
                <div class="service-meta">
                    <div class="worker-info">
                        <div class="worker-avatar">${service.worker.charAt(0)}</div>
                        <span class="worker-name">${service.worker}</span>
                    </div>
                    <div class="service-rating">
                        <span class="material-symbols-outlined" style="font-size: 18px;">star</span>
                        ${service.rating}
                    </div>
                </div>
            </div>
        </div>
    `).join('');
}

function openServiceModal(id) {
    const service = services.find(s => s.id === id);
    if (!service) return;
    currentService = service;
    
    document.getElementById('modalIcon').textContent = service.icon;
    document.getElementById('modalTitle').textContent = service.title;
    document.getElementById('modalPrice').textContent = `${service.price} ‚ÇΩ/—á–∞—Å`;
    document.getElementById('modalDescription').textContent = service.fullDescription;
    
    const charsHtml = Object.entries(service.characteristics).map(([label, value]) => `
        <div class="characteristic-item">
            <span class="characteristic-label">${label}</span>
            <span class="characteristic-value">${value}</span>
        </div>
    `).join('');
    document.getElementById('modalCharacteristics').innerHTML = charsHtml;
    
    const photosHtml = service.photos.map(photo => `<div class="photo-item">${photo}</div>`).join('');
    document.getElementById('modalPhotos').innerHTML = photosHtml;
    
    const initials = service.worker.split(' ').map(n => n[0]).join('');
    document.getElementById('modalWorkerAvatar').textContent = initials;
    document.getElementById('modalWorkerName').textContent = service.worker;
    document.getElementById('modalWorkerRole').textContent = service.workerRole;
    document.getElementById('modalWorkerRating').textContent = service.rating;
    
    const reviewsHtml = service.reviews.map(review => `
        <div class="review-item">
            <div class="review-header">
                <span class="review-author">${review.author}</span>
                <span class="review-date">${review.date}</span>
            </div>
            <div class="review-text">${review.text}</div>
        </div>
    `).join('');
    document.getElementById('modalReviews').innerHTML = reviewsHtml;
    
    document.getElementById('serviceModal').classList.add('active');
    document.body.style.overflow = 'hidden';
}

function filterServices() {
    const category = document.getElementById('categoryFilter').value;
    const maxPrice = document.getElementById('priceFilter').value;
    let filtered = services;
    if (category) filtered = filtered.filter(s => s.category === category);
    if (maxPrice) filtered = filtered.filter(s => s.price <= parseInt(maxPrice));
    renderServices(filtered);
}

function searchServices() {
    const query = document.getElementById('searchInput').value.toLowerCase();
    const filtered = services.filter(s => s.title.toLowerCase().includes(query) || s.description.toLowerCase().includes(query));
    renderServices(filtered);
}

function contactWorker() { if (currentService) alert(`–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è ${currentService.worker}`); }

function orderService() {
    if (currentService) {
        const token = localStorage.getItem('accessToken');
        const role = localStorage.getItem('userRole');
        if (!token) {
            alert('–î–ª—è –∑–∞–∫–∞–∑–∞ —É—Å–ª—É–≥–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É!');
            closeServiceModal();
            openLoginModal();
        } else if (role !== 'customer') {
            alert('–¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∑–∞–∫–∞–∑—ã–≤–∞—Ç—å —É—Å–ª—É–≥–∏!');
        } else {
            openOrderForm(currentService);
        }
    }
}

function openOrderForm(service) {
    const formHtml = `
        <div id="orderFormModal" class="modal active">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìã –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
                    <button class="modal-close" onclick="closeOrderForm()">√ó</button>
                </div>
                <div class="modal-body">
                    <div style="background: #f8fafc; padding: 16px; border-radius: 8px; margin-bottom: 20px;">
                        <strong>${service.title}</strong><br>
                        <span style="color: #135bec; font-size: 20px; font-weight: 700;">${service.price} ‚ÇΩ/—á–∞—Å</span>
                    </div>
                    <form id="orderForm" onsubmit="submitOrder(event)">
                        <div class="form-group"><label>–í–∞—à–µ –∏–º—è</label><input type="text" id="orderName" required></div>
                        <div class="form-group"><label>–¢–µ–ª–µ—Ñ–æ–Ω</label><input type="tel" id="orderPhone" required></div>
                        <div class="form-group"><label>–ê–¥—Ä–µ—Å –æ–±—ä–µ–∫—Ç–∞</label><input type="text" id="orderAddress" required></div>
                        <div class="form-group"><label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</label><textarea id="orderDesc" rows="3"></textarea></div>
                        <button type="submit" class="btn btn-primary" style="width: 100%;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
                    </form>
                </div>
            </div>
        </div>
    `;
    document.body.insertAdjacentHTML('beforeend', formHtml);
}

function closeOrderForm() { const modal = document.getElementById('orderFormModal'); if (modal) modal.remove(); }

async function submitOrder(event) {
    event.preventDefault();
    const token = localStorage.getItem('accessToken');
    const orderData = {
        service_title: currentService.title,
        service_description: document.getElementById('orderDesc').value,
        price: currentService.price,
        customer_name: document.getElementById('orderName').value,
        customer_phone: document.getElementById('orderPhone').value,
        customer_address: document.getElementById('orderAddress').value
    };
    try {
        const response = await fetch('/api/create-order', {
            method: 'POST',
            headers: { 'Authorization': 'Bearer ' + token, 'Content-Type': 'application/json' },
            body: JSON.stringify(orderData)
        });
        const data = await response.json();
        if (data.success) {
            alert('‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!');
            closeOrderForm();
            closeServiceModal();
            window.location.href = '/customer.html';
        } else {
            alert('‚ùå ' + data.message);
        }
    } catch (error) {
        alert('‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏');
    }
}

window.onclick = function(event) {
    if (event.target === document.getElementById('serviceModal')) closeServiceModal();
    if (event.target === document.getElementById('loginModal')) closeLoginModal();
}
</script>
</body>
</html>